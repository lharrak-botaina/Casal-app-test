<div class="add-company-container">
  <form [formGroup]="COMPANY_FORM" (submit)="COMPANY_FORM.valid && add()">
    <mat-horizontal-stepper #stepper [linear]="false">
      <!-- Step 1: General Information -->
      <mat-step>
        <ng-template matStepLabel>Informations générales</ng-template>
        <div class="step-content-card">
          <div class="form-section">
            <div class="section-header">
              <div class="section-icon">
                <mat-icon>business</mat-icon>
              </div>
              <h3 class="section-title">Informations de l'entreprise</h3>
            </div>

            <div class="form-row">
              <div class="form-field-half">
                <app-text-input
                  [formControl]="COMPANY_FORM.controls['name']"
                  [label]="'Nom*'"
                ></app-text-input>
              </div>
              <div class="form-field-half">
                <app-select-input
                  [formControl]="COMPANY_FORM.controls['activity_area']"
                  [label]="'Secteur d\'activité*'"
                  [options]="ACTIVITY_AREA"
                ></app-select-input>
              </div>
            </div>

            <div class="form-row">
              <div class="form-field-half">
                <app-text-input
                  [formControl]="COMPANY_FORM.controls['email']"
                  [label]="'Email*'"
                ></app-text-input>
              </div>
              <div class="form-field-half">
                <app-text-input
                  [formControl]="COMPANY_FORM.controls['address']"
                  [label]="'Adresse'"
                ></app-text-input>
              </div>
            </div>

            <div class="form-row">
              <div class="form-field-half">
                <app-text-input
                  [formControl]="COMPANY_FORM.controls['password']"
                  [type]="'password'"
                  [label]="'Mot de passe*'"
                ></app-text-input>
              </div>
              <div class="form-field-half">
                <app-text-input
                  [formControl]="COMPANY_FORM.controls['repeat_password']"
                  [type]="'password'"
                  [label]="'Répéter le mot de passe*'"
                ></app-text-input>
              </div>
            </div>

            <div class="form-row">
              <div class="form-field-half">
                <app-select-input
                  [formControl]="COMPANY_FORM.controls['city']"
                  [label]="'Ville*'"
                  [options]="CITIES"
                ></app-select-input>
              </div>
              <div class="form-field-half">
                <app-file-input
                  [formControl]="COMPANY_FORM.controls['logo']"
                  [label]="'Logo'"
                  [accept]="accept"
                ></app-file-input>
              </div>
            </div>
          </div>

          <div class="step-navigation">
            <span></span>
            <button class="btn-next" type="button" matStepperNext>
              Suivant
              <mat-icon>arrow_forward</mat-icon>
            </button>
          </div>
        </div>
      </mat-step>

      <!-- Step 2: Social Media -->
      <mat-step>
        <ng-template matStepLabel>Réseaux sociaux</ng-template>
        <div class="step-content-card">
          <div class="form-section">
            <div class="section-header">
              <div class="section-icon">
                <mat-icon>share</mat-icon>
              </div>
              <h3 class="section-title">Réseaux sociaux</h3>
            </div>

            <ng-container formGroupName="socialMedia">
              <div class="form-row">
                <div class="form-field-half">
                  <app-text-input
                    [formControl]="COMPANY_FORM.get('socialMedia')['controls']['facebook']"
                    [label]="'Facebook'"
                  ></app-text-input>
                </div>
                <div class="form-field-half">
                  <app-text-input
                    [formControl]="COMPANY_FORM.get('socialMedia')['controls']['twitter']"
                    [label]="'Twitter'"
                  ></app-text-input>
                </div>
              </div>

              <div class="form-row">
                <div class="form-field-half">
                  <app-text-input
                    [formControl]="COMPANY_FORM.get('socialMedia')['controls']['instagram']"
                    [label]="'Instagram'"
                  ></app-text-input>
                </div>
                <div class="form-field-half">
                  <app-text-input
                    [formControl]="COMPANY_FORM.get('socialMedia')['controls']['linkedIn']"
                    [label]="'LinkedIn'"
                  ></app-text-input>
                </div>
              </div>
            </ng-container>
          </div>

          <div class="step-navigation">
            <button class="btn-back" type="button" matStepperPrevious>
              <mat-icon>arrow_back</mat-icon>
              Retour
            </button>
            <button class="btn-next" type="button" matStepperNext>
              Suivant
              <mat-icon>arrow_forward</mat-icon>
            </button>
          </div>
        </div>
      </mat-step>

      <!-- Step 3: Person Contacted -->
      <mat-step>
        <ng-template matStepLabel>Représentant</ng-template>
        <div class="step-content-card">
          <div class="form-section">
            <div class="section-header">
              <div class="section-icon">
                <mat-icon>person</mat-icon>
              </div>
              <h3 class="section-title">Représentant</h3>
            </div>

            <ng-container formGroupName="person_contacted">
              <div class="form-row">
                <div class="form-field-half">
                  <app-text-input
                    [formControl]="COMPANY_FORM.get('person_contacted')['controls']['fullname']"
                    [label]="'Nom et Prénom*'"
                  ></app-text-input>
                </div>
                <div class="form-field-half">
                  <app-text-input
                    [formControl]="COMPANY_FORM.get('person_contacted')['controls']['email']"
                    [label]="'Email*'"
                  ></app-text-input>
                </div>
              </div>

              <div class="form-row">
                <div class="form-field-half">
                  <app-text-input
                    [formControl]="COMPANY_FORM.get('person_contacted')['controls']['phone']"
                    [label]="'Téléphone*'"
                    [type]="'tel'"
                  ></app-text-input>
                </div>
                <div class="form-field-half">
                  <!-- Empty for layout balance -->
                </div>
              </div>
            </ng-container>
          </div>

          <div class="step-navigation">
            <button class="btn-back" type="button" matStepperPrevious>
              <mat-icon>arrow_back</mat-icon>
              Retour
            </button>
            <button class="btn-next" type="button" matStepperNext>
              Suivant
              <mat-icon>arrow_forward</mat-icon>
            </button>
          </div>
        </div>
      </mat-step>

      <!-- Step 4: Finalization -->
      <mat-step>
        <ng-template matStepLabel>Finaliser</ng-template>
        <div class="step-content-card">
          <div class="final-step">
            <div class="success-icon-wrapper">
              <div class="success-circle">
                <mat-icon class="check-icon">task_alt</mat-icon>
              </div>
              <div class="decoration-dots"></div>
            </div>

            <h2 class="success-title">Prêt à soumettre!</h2>
            <p class="success-message">
              Vous avez complété toutes les étapes. Vérifiez vos informations et soumettez le formulaire.
            </p>

            <div class="final-actions">
              <button class="btn-back" type="button" matStepperPrevious>
                <mat-icon>arrow_back</mat-icon>
                Retour
              </button>
              <button
                class="btn-submit"
                [disabled]="!COMPANY_FORM.valid"
                type="submit"
              >
                <mat-icon>check_circle</mat-icon>
                Enregistrer
              </button>
            </div>
          </div>
        </div>
      </mat-step>
    </mat-horizontal-stepper>
  </form>
</div>
