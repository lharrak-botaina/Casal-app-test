<!-- Personal Information Section -->
<div class="form-section">
  <div class="section-header">
    <div class="section-icon">
      <mat-icon>person</mat-icon>
    </div>
    <h4 class="section-title">Informations Personnelles</h4>
  </div>

  <div class="form-grid">
    <div>
      <app-text-input [formControl]="PERSONAL_INFO.controls['fullname']" [label]="'Nom et Prénom*'"></app-text-input>
    </div>
    <div>
      <app-file-input [formControl]="PERSONAL_INFO.controls['photo']" [label]="'Photo'"></app-file-input>
    </div>
    <div>
      <app-select-input [formControl]="PERSONAL_INFO.controls['connectedBy']"
        [label]="'Comment avez-vous connu notre service ?'" [bold]="true" [options]="Data.CONNECTED_BY">
      </app-select-input>
    </div>
    <div>
      <app-select-input [formControl]="PERSONAL_INFO.controls['isPriority']" [label]="'Prioritaire'"
        [options]="Data.YES_OR_NO" [deselectValue]="false" [bold]="true">
      </app-select-input>
    </div>
    <div>
      <app-text-input [formControl]="PERSONAL_INFO.controls['address']" [label]="'Adresse'"></app-text-input>
    </div>
    <div>
      <app-select-input [formControl]="PERSONAL_INFO.controls['city']" [bold]="true" [label]="'Ville'" [options]="Data.CITIES">
      </app-select-input>
    </div>
    <div>
      <app-date-input [formControl]="PERSONAL_INFO.controls['birth_date']" [label]="'Date de naissance'"
        [maxDate]="maxDate">
      </app-date-input>
    </div>
    <div>
      <app-select-input [formControl]="PERSONAL_INFO.controls['gendre']" [bold]="true" [label]="'Sexe'" [options]="Data.GENDER">
      </app-select-input>
    </div>
    <div>
      <app-text-input [formControl]="PERSONAL_INFO.controls['phone']" [label]="'Téléphone'"></app-text-input>
    </div>
    <div>
      <app-text-input [formControl]="PERSONAL_INFO.controls['cin_id']" [label]="'CIN'"></app-text-input>
    </div>
    <div>
      <app-text-input [formControl]="PERSONAL_INFO.controls['cnss_id']" [label]="'CNSS'"></app-text-input>
    </div>
    <div>
      <app-date-input [formControl]="PERSONAL_INFO.controls['inscription_date']" [label]="'Date d\'inscription'"
        [maxDate]="maxDate">
      </app-date-input>
    </div>
    <div>
      <app-select-input [formControl]="PERSONAL_INFO.controls['nationality']" [label]="'Nationalité'"
        [options]="Data.NATIONALITIES" [bold]="true"></app-select-input>
    </div>
    <div *ngIf="isNotMoroccan()" class="conditional-field">
      <app-textarea-input [formControl]="PERSONAL_INFO.controls['nationality_comment']"
        [label]="'Nationalité commentaire'">
      </app-textarea-input>
    </div>
    <div>
      <app-select-input [formControl]="PERSONAL_INFO.controls['housing']" [bold]="true" [label]="'Logement'"
        [options]="Data.HOUSING"></app-select-input>
    </div>
  </div>
</div>

<!-- Marital Status Section -->
<div class="form-section">
  <div class="section-header">
    <div class="section-icon">
      <mat-icon>family_restroom</mat-icon>
    </div>
    <h4 class="section-title">Situation Matrimoniale</h4>
  </div>

  <div class="form-grid">
    <div>
      <app-select-input [formControl]="PERSONAL_INFO.controls['civil_status']" [label]="'Etat civil'"
        [options]="Data.CIVIL_STATUS" [bold]="true"></app-select-input>
    </div>
    <div>
      <app-text-input [formControl]="PERSONAL_INFO.controls['kids_nbr']" [label]="'Nbr. d\'enfants'"
        [type]="'number'"></app-text-input>
    </div>
  </div>
</div>

<!-- Socio-Economic Status Section -->
<div class="form-section">
  <div class="section-header">
    <div class="section-icon">
      <mat-icon>account_balance_wallet</mat-icon>
    </div>
    <h4 class="section-title">Situation Socio-Economique</h4>
  </div>

  <div class="form-grid">
    <div>
      <app-text-input [formControl]="PERSONAL_INFO.controls['people_in_charge_nbr']"
        [label]="'Nbr de personne à charge'" [type]="'number'"></app-text-input>
    </div>
    <div>
      <app-text-input [formControl]="PERSONAL_INFO.controls['current_function']"
        [label]="'Situation Actuelle'"></app-text-input>
    </div>
  </div>
</div>

<!-- Interests Section -->
<div class="form-section">
  <div class="section-header">
    <div class="section-icon">
      <mat-icon>interests</mat-icon>
    </div>
    <h4 class="section-title">Centre d'Intérêt</h4>
  </div>

  <div class="form-grid">
    <div class="hobby-field">
      <mat-form-field class="w-100" appearance="outline">
        <mat-label>Loisirs</mat-label>
        <mat-chip-grid #chipGrid aria-label="Hobbies selection">
          <mat-chip-row *ngFor="let hobby of hobbies" [removable]="true" (removed)="remove(hobby)">
            {{ hobby }}
            <button matChipRemove>
              <mat-icon>cancel</mat-icon>
            </button>
          </mat-chip-row>
        </mat-chip-grid>
        <input placeholder="Nouveau loisir..." [matChipInputFor]="chipGrid"
          [matChipInputSeparatorKeyCodes]="separatorKeysCodes" [matChipInputAddOnBlur]="true"
          (matChipInputTokenEnd)="addHobby($event)" />
      </mat-form-field>
    </div>
  </div>
</div>

<!-- Physical State Section -->
<div class="form-section">
  <div class="section-header">
    <div class="section-icon">
      <mat-icon>health_and_safety</mat-icon>
    </div>
    <h4 class="section-title">Etat Physique</h4>
  </div>

  <ng-container [formGroup]="PERSONAL_INFO.controls['physical_state']">
    <!-- Addiction -->
    <ng-container [formGroup]="PERSONAL_INFO.get('physical_state')['controls']['addiction']">
      <div class="form-grid">
        <div>
          <app-select-input [formControl]="
              PERSONAL_INFO.get('physical_state')['controls']['addiction'][
                'controls'
              ]['status']
            " [label]="'Le bénéficiaire souffre t-il d\'une addiction ?'" [options]="Data.YES_OR_NO"
            [deselectValue]="false" [bold]="true"></app-select-input>
        </div>
        <div *ngIf="hasAddiction()" class="conditional-field">
          <app-textarea-input [formControl]="
              PERSONAL_INFO.get('physical_state')['controls']['addiction'][
                'controls'
              ]['description']
            " [label]="'Détails'" [placeholder]="'Remplir vos données...'"></app-textarea-input>
        </div>
      </div>
    </ng-container>

    <!-- Handicap -->
    <ng-container [formGroup]="PERSONAL_INFO.get('physical_state')['controls']['handicap']">
      <div class="form-grid" style="margin-top: 16px;">
        <div>
          <app-select-input [formControl]="
              PERSONAL_INFO.get('physical_state')['controls']['handicap'][
                'controls'
              ]['status']
            " [label]="'Le bénéficiaire souffre t-il d\'un handicap quelconque ?'" [options]="Data.YES_OR_NO"
            [deselectValue]="false" [bold]="true"></app-select-input>
        </div>
        <div *ngIf="hasHandicap()" class="conditional-field">
          <app-textarea-input [formControl]="
              PERSONAL_INFO.get('physical_state')['controls']['handicap'][
                'controls'
              ]['description']
            " [label]="'Détails'" [placeholder]="'Remplir vos données...'"></app-textarea-input>
        </div>
      </div>
    </ng-container>

    <!-- Health Issues -->
    <ng-container [formGroup]="
        PERSONAL_INFO.get('physical_state')['controls']['health_issue']
      ">
      <div class="form-grid" style="margin-top: 16px;">
        <div>
          <app-select-input [formControl]="
              PERSONAL_INFO.get('physical_state')['controls']['health_issue'][
                'controls'
              ]['status']
            " [label]="'Le bénéficiaire souffre t-il d\'une maladie chronique ?'" [options]="Data.YES_OR_NO"
            [deselectValue]="false" [bold]="true"></app-select-input>
        </div>
        <div *ngIf="hasHealthIssue()" class="conditional-field">
          <app-textarea-input [formControl]="
              PERSONAL_INFO.get('physical_state')['controls']['health_issue'][
                'controls'
              ]['chronic_illness']
            " [label]="'Détails'" [placeholder]="'Remplir vos données...'"></app-textarea-input>
        </div>
      </div>
      <div class="form-grid" *ngIf="hasHealthIssue()" style="margin-top: 16px;">
        <div class="form-field-full conditional-field">
          <app-textarea-input [formControl]="
              PERSONAL_INFO.get('physical_state')['controls']['health_issue'][
                'controls'
              ]['ongoing_treatment']
            " [label]="
              'Le bénéficiaire a-t-il eu un antécédent médical qui pourrait affecter son rendement au travail ?'
            " [placeholder]="'Remplir vos données...'"></app-textarea-input>
        </div>
      </div>
    </ng-container>
  </ng-container>
</div>
